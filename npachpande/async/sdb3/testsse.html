<html>
<head>
	<title>sdb3 Test SSE Response</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
</head>
<body>

	<label for="jwtToken">JWT:</label></br>
	<input type="text" id="jwtToken" name="jwtToken" size="50"></br>
	<label for="lastEventId">LastEventId:</label></br>
	<input type="text" id="lastEventId" name="lastEventId" size="50"></br>
	<button type="button" onclick="subscribeToSSE()"> Subscribe to SSE </button></br></br>

	<script type='text/javascript'>
		const DEFAULT_JWT = "eyJraWQiOiI2ZjUxNmMwOTMxZTQwODkxYzMyODliN2ZjZDcyZDZjY2RiYzQwMTAwMDczMWU2ZmFkNzM3ZDk1MjRiYWUyY2FhIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ2Mi9pYW1lc3NhZ2UvVU5BVVRIL05BL3VpZDo2MjQ2ODEwMS0xMTJkLTQwNWMtYjg3Ni1kNDZmYTE4ZWI0YjMiLCJjbGllbnRJZCI6InYxL01lc3NhZ2luZ18xMy9lNTg3YjYwZC1iYmFjLTQyYmItOWZkMS05N2RhNGJiODRhNjUiLCJjaGFubmVsQWRkSWQiOiJhMWU2N2JhOS1iZjY1LTQ2ZjQtODZhMS05OTFhYzIyOGZlMTEiLCJpc3MiOiJpYW1lc3NhZ2UiLCJkZXZpY2VJZCI6ImI0NjhiMmZhLTRlZjAtNDJjOC1hNGI1LTE1YTY0ZDVhMjZlZSIsImNhcGFiaWxpdGllc1ZlcnNpb24iOiIyNDYiLCJvcmdJZCI6IjAwRFNCMDAwMDAwMkxBMSIsImRldmljZUluZm8iOiJ7XCJvc1wiOlwiTWFjaW50b3NoXCIsXCJvc1ZlcnNpb25cIjpcIjEwLjE1N1wiLFwiYnJvd3NlclwiOlwiQ2hyb21lXCIsXCJicm93c2VyVmVyc2lvblwiOlwiMTE1XCJ9Iiwiand0SWQiOiI0clNqbGVvNEZUS3Y4Z3VteVRrdVZrIiwiY2xpZW50U2Vzc2lvbklkIjoiNDViM2JjNzQtMDFkYy00ODU1LWIzMjctODJkOGIxOTJkNWMwIiwiYXVkIjoiVVNFUiIsImV2dEtleSI6InNjcnQudGVzdC5ldmVudHJvdXRlcl9fYXdzLnRlc3QxLXVzd2VzdDIudW5pZmllZC1lbmdhZ2VtZW50LmFqbmFsb2NhbDFfX3B1YmxpYy5ldmVudHMuc2NydDAxOjQ0Iiwiandrc191cmkiOiJodHRwczovL3NjcnQwMS51bmlmaWVkLWVuZ2FnZW1lbnQuc2ZkYy1ja3pxZ2Muc3ZjLnNmZGNmYy5uZXQvaWFtZXNzYWdlL3YxLy53ZWxsLWtub3duL2p3a3MuanNvbj9rZXlJZD02ZjUxNmMwOTMxZTQwODkxYzMyODliN2ZjZDcyZDZjY2RiYzQwMTAwMDczMWU2ZmFkNzM3ZDk1MjRiYWUyY2FhIiwiZXNEZXBsb3ltZW50VHlwZSI6IldlYiIsImV4cCI6MTY5MTIwMjI4NCwiaWF0IjoxNjkwOTQzMDg0fQ.oXZgJy7RcU1qxN8ugsjamU2Wq3d-zhUEwAXqEOEt8yadYs4rnUbAEzFg-bUH3a7DVHYHYw3cY6C0CDWgFJwDbwUsfLCLW-sddI4xoesG5jV0glyMwBHWrJXfYhuE-1b6ewjwzWdke-ZXp1Y9NnclstcO_4TUJryM4GuTJBcLan_oWXV4IBpzi8rOv_6oQpHZ5zLVATwJ16AVNWkozKBFX3DNppp58M53mAe26oGm2x0DPcLFVT7nAHhRGhKSYZG8gsXv4anTGT99VfzSeO9sSZM0GMGZRckDoQUTCkC_nFomT0rjHKXqeGLN7Ix-QuHGwwuzFAS4rhgcwqOZa50PnQ";
		const DEFAULT_LASTEVENTID = "458045";
		document.getElementById("jwtToken").value = DEFAULT_JWT;
		document.getElementById("lastEventId").value = DEFAULT_LASTEVENTID;

		function subscribeToSSE() {
			const jwt = document.getElementById("jwtToken").value;
			const lastEventId = document.getElementById("lastEventId").value;
			const endpoint = "https://eswmessagingchat.test1.my.pc-rnd.salesforce-scrt.com/eventrouter/v1/sse";

			fetch(endpoint, {
				method: "GET",
				mode: "cors",
				headers: {
					"Authorization": "Bearer " + jwt,
					"Last-Event-Id": lastEventId,
					"X-Org-Id": "00DSB0000002LA1"
				}
			})
			.then(response => response.json())
		    	.then(responseData => console.log(responseData))
			.catch(function(err) {
				console.log('Fetch Error :', err);
			});
		}
	</script>


</body>
</html>
