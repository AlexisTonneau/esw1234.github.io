<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
   <head>
</head>
<body>
	<p><a id="editThisPageLink" target="_blank" style="color:blue">Edit this page</a></p>
	<div style="position: absolute; bottom: 200px"><button type="button" onclick="loadVerifiedDeployment()">Load verified deployment</button></div>


<script type='text/javascript'>
	document.getElementById('editThisPageLink').href = "https://github.com/ESW1234/esw1234.github.io/edit/master" + window.location.pathname;		

	function waitForRemoveMarkup() {
		if(document.getElementById("embedded-messaging")) {
			window.setTimeout( waitForRemoveMarkup, 100);
		} else {
			//remove remaining DOM items, event handler
			document.getElementById("unauthBootstrapScript").remove();
			document.getElementById("unauthBootstrapScriptSrc").remove();
			document.getElementByid("embeddedMessagingSiteContextFrame").remove();
			document.getElementById("embedded-messaging").remove();
			embeddedservice_bootstrap.removeEventHandlers();	
			//now that we have called all the APIs we need, unset this so we can load other deployment
			embeddedservice_bootstrap = undefined;
		}
	}
	
	function clearUnauthSession() {
		console.log("Clearing user session.");
		//this flag prevents script from regenerating DOM after we remove it
		embeddedservice_bootstrap.settings.embeddedServiceConfig.embeddedServiceMessagingChannel.authMode = null

		//end existing session, remove event handlers	
		embeddedservice_bootstrap.userVerificationAPI.clearSession(); //this also clears DOM elements
		waitForRemoveMarkup();
	}

	function loadBootstrapScript(scriptUrl, orgId, deploymentName, siteUrl, scrtUrl) {
		var s = document.createElement('script');
		s.setAttribute('src', scriptUrl);
		s.onload = function() {
			initEmbeddedMessaging(orgId, deploymentName, siteUrl, scrtUrl);
		};
		document.body.appendChild(s);
	}
	
	function loadVerifiedDeployment() {
		clearUnauthSession();
		loadBootstrapScript(
			"https://esw-sdb3-blitz.test1.my.pc-rnd.site.com/ESWwebMessaging041674063807205/assets/js/bootstrap.js", 
			"00DSB0000005YCL",
			"webMessaging04", 
			"https://esw-sdb3-blitz.test1.my.pc-rnd.site.com/ESWwebMessaging041674063807205",
			"https://esw-sdb3-blitz.test1.my.pc-rnd.salesforce-scrt.com");
	}

	function initEmbeddedMessaging(orgId, deploymentName, siteUrl, scrtUrl) {
		try {
			embeddedservice_bootstrap.settings.language = 'en'; // For example, enter 'en' or 'en-US'

			embeddedservice_bootstrap.init(
				orgId,
				deploymentName,
				siteUrl,
				{
					scrt2URL: scrtUrl,
        			});
		} catch (err) {
			console.error('Error loading Embedded Messaging: ', err);
		}
	};
</script>
	
<script id="unauthBootstrapScript" type='text/javascript'>
	function initEmbeddedMessaging() {
		try {
			embeddedservice_bootstrap.settings.language = 'en'; // For example, enter 'en' or 'en-US'
			embeddedservice_bootstrap.settings.devMode = true;

			embeddedservice_bootstrap.init(
				'00DSB0000005YCL',
				'webMessaging03',
				'https://esw-sdb3-blitz.test1.my.pc-rnd.site.com/ESWwebMessaging031674063746989',
				{
					scrt2URL: 'https://esw-sdb3-blitz.test1.my.pc-rnd.salesforce-scrt.com'
				}
			);
		} catch (err) {
			console.error('Error loading Embedded Messaging: ', err);
		}
	};
</script>
<script id="unauthBootstrapScriptSrc" type='text/javascript' src='https://esw-sdb3-blitz.test1.my.pc-rnd.site.com/ESWwebMessaging031674063746989/assets/js/bootstrap.js' onload='initEmbeddedMessaging()'></script>

   </body>
</html>
    <style>
       body {
          
         background: url("https://esw1234.github.io/Spotify-large.png") no-repeat;
      }
      #button_goes_here{
            width: 100%; 
            height: 100%; 
            margin: 0 auto;
            position: relative;
            
      }
    </style>
