<html>
   <head>
       <title>Local 242/patch Messaging page</title>
       <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=0">
   </head>
   <body>
	<button type="button" id="clearAuthBtn" onclick="clearAuthSession()"> Clear Authorization Session </button>

	<script type='text/javascript'>
		function clearAuthSession() {
			console.log("Clearing user session.");
			embeddedservice_bootstrap.userVerificationAPI.clearSession();
		}
		
		window.addEventListener("onEmbeddedMessagingReady", () => {
			console.log("onEmbeddedMessagingReady emitted");

			// Setting identity token
			console.log("Setting identity token.");
			embeddedservice_bootstrap.userVerificationAPI.setIdentityToken({
				"identityTokenType":"JWT",
				// Valid JWT
				"identityToken": `
					eyJraWQiOiI1ZjEwM2YxYi1lZTM4LTQwNGMtYWM5NC04M2M0Mjc3NjQ4MTMiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJpYW1lc3NhZ2UiLCJzdWIiOiJhYmNkZWZnaEBnbWFpbC5jb20iLCJleHAiOjE2NzEwNjU1MzUsImlhdCI6MTY3MTA2MzUzNX0.bAjmXOmFexFL-5pJOlpbRivGOYKOWOguH-NnaXw7brqvzwJkzg1-seSphhq0xDt3iwb1mxEMb6kEXQG1pNlfZm4mAltS16GX9HDSNuznilu8bT6l8I1yyJCGb6-vep3IW-5iV4iWSoNwNvvGYKmT-FSrRrTLeraLa_qS2M8dxGfbKNrrSRQoArfCxTHaWwOBQk6RB2ra1V8j7K1U9LdyP4mN0WTkqzn80PQQIvV66RVA1lW6Q6E4dVyAKEDPqLbDVNn1AQ3dFZGXLhpzwo2nPkk2yTxEXalds69W7n5YB25CFuFTgXILpFmit7BOp7hCxWzorDTYu-ll9i_jOK_teA
				`,
			});
		});
	  </script>
	<script type='text/javascript'>
		function initEmbeddedMessaging() {
			try {
				embeddedservice_bootstrap.settings.language = 'en'; // For example, enter 'en' or 'en-US'
				embeddedservice_bootstrap.settings.devMode = true; 
				
				/**
				embeddedservice_bootstrap.settings.embeddedServiceConfig = {
					embeddedServiceMessagingChannel: {
						authMode: "Auth"
					}
				}**/
				embeddedservice_bootstrap.init(
					'00DSB0000004st3',
					'MIAW_Local',
					'https://godwinlaw.my.localhost.sfdcdev.site.com:6101/ESWMIAW1669750683619',
					{
						scrt2URL: 'https://godwinlaw-sdb3.test1.my.pc-rnd.salesforce-scrt.com'
					}
				);
			} catch (err) {
				console.error('Error loading Embedded Messaging: ', err);
			}
		};
	</script>
	<!--
	<script type='text/javascript' src='https://godwinlaw-sdb3.test1.pc-rnd.force.com/ESWMIAWLocal1669917994477/assets/js/bootstrap.min.js' onload='initEmbeddedMessaging()'></script>
	-->	
	<script type='text/javascript' src='https://godwinlaw.my.localhost.sfdcdev.site.com:6101/ESWMIAW1669750683619/assets/js/bootstrap.js' onload='initEmbeddedMessaging()'></script>   </body>
</html>
