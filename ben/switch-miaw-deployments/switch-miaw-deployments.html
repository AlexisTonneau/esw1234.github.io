<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
   <head>
</head>
<body>
	<p><a id="editThisPageLink" target="_blank" style="color:blue">Edit this page</a></p>
	<div style="position: absolute; bottom: 200px"><button type="button" onclick="loadVerifiedDeployment()">Load verified deployment</button></div>


//this is a script to switch to a verified deployment
<script type='text/javascript'>
	document.getElementById('editThisPageLink').href = "https://github.com/ESW1234/esw1234.github.io/edit/master" + window.location.pathname;		
	
	function loadVerifiedDeployment() {
		console.log("Clearing user session.");
		//save this reference so we know when we've finished with clearSession
		let emEl = document.getElementById("embedded-messaging")

		//end existing session, remove event handlers	
		embeddedservice_bootstrap.userVerificationAPI.clearSession(); //this also clears DOM elements
		waitForClearSession(emEl);
	}

	function waitForClearSession(emEl) {
		if(document.getElementById("embedded-messaging") === emEl) {
			window.setTimeout( waitForClearSession, 100, emEl);
		} else {
			embeddedservice_bootstrap.removeMarkup();
			//remove remaining DOM items, event handler
			document.getElementById("unauthBootstrapScript").remove();
			document.getElementById("unauthBootstrapScriptSrc").remove();
			document.getElementById("embeddedMessagingSiteContextFrame").remove();
			embeddedservice_bootstrap.removeEventHandlers();	
			//now that we have called all the APIs we need, unset this so we can load other deployment
			embeddedservice_bootstrap = undefined;
		}
	}

	function loadBootstrapScript(scriptUrl, orgId, deploymentName, siteUrl, scrtUrl) {
		var s = document.createElement('script');
		s.setAttribute('src', scriptUrl);
		s.onload = function() {
			try {
				embeddedservice_bootstrap.settings.language = 'en'; // For example, enter 'en' or 'en-US'
				embeddedservice_bootstrap.init(
					orgId,
					deploymentName,
					siteUrl,
					{
						scrt2URL: scrtUrl,
        			});
			} catch (err) {
				console.error('Error loading Embedded Messaging: ', err);
			}
		};
		document.body.appendChild(s);
	}
</script>

//This is the vanilla generated snippet for an unverified deployment
<script id="unauthBootstrapScript" type='text/javascript'>
	function initEmbeddedMessaging() {
		try {
			embeddedservice_bootstrap.settings.language = 'en'; // For example, enter 'en' or 'en-US'
			embeddedservice_bootstrap.settings.devMode = true;

			embeddedservice_bootstrap.init(
				'00DSB0000005YCL',
				'webMessaging03',
				'https://esw-sdb3-blitz.test1.my.pc-rnd.site.com/ESWwebMessaging031674063746989',
				{
					scrt2URL: 'https://esw-sdb3-blitz.test1.my.pc-rnd.salesforce-scrt.com'
				}
			);
		} catch (err) {
			console.error('Error loading Embedded Messaging: ', err);
		}
	};
</script>
<script id="unauthBootstrapScriptSrc" type='text/javascript' src='https://esw-sdb3-blitz.test1.my.pc-rnd.site.com/ESWwebMessaging031674063746989/assets/js/bootstrap.js' onload='initEmbeddedMessaging()'></script>

   </body>
</html>
    <style>
       body {
          
         background: url("https://esw1234.github.io/Spotify-large.png") no-repeat;
      }
      #button_goes_here{
            width: 100%; 
            height: 100%; 
            margin: 0 auto;
            position: relative;
            
      }
    </style>
