
<html>

<head>
	<title>SDB3-MIAW</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
</head>

<body>
	<h2> MIAW - Omni2 GA Skill Based Routing</h2>
	Agent: m1@na45a.o2 
	<p><a id="editThisPageLink" target="_blank" style="color:blue">Edit this page</a></p>

	<text id="jwtToken" name="skill" rows="7" cols="100"></text><br><br>
	<button type="button" id="authBtn" onclick="setSkill()"> Set Skill </button><br><br>
	
	<textarea id="jwtToken" name="jwtToken" rows="7" cols="100"></textarea><br><br>
	<button type="button" id="authBtn" onclick="authenticate()"> Authenticate User </button><br><br>
	<button type="button" id="clearAuthBtn" onclick="clearAuthSession()"> Clear User Session </button>
	
	<script>document.getElementById('editThisPageLink').href = "https://github.com/ESW1234/esw1234.github.io/edit/master" + window.location.pathname

		function setSkill() {
			console.log("Setting Skill: " + document.getElementById("skill").value);
			embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({ "Skill": document.getElementById("skill").value) });
		}
		
		function clearAuthSession() {
			console.log("Clearing user session.");
			embeddedservice_bootstrap.userVerificationAPI.clearSession();
		}

		function authenticate() {
			var jwt = {
				identityTokenType: "JWT",
				identityToken: document.getElementById("jwtToken").value
			}
			console.log("Authenticating User.");
			console.log("JWT Token: " + JSON.stringify(jwt));
			console.log("Auth API Response: " + embeddedservice_bootstrap.userVerificationAPI.setIdentityToken(jwt));
		}
	</script>
	<script type='text/javascript'>
		function initEmbeddedMessaging() {
			try {
				embeddedservice_bootstrap.settings.language = 'en'; // For example, enter 'en' or 'en-US'
				window.addEventListener("onEmbeddedMessagingReady", () => {
					embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({ "Browser": "Browser Chrome 106", "OS": "Mac OS 1.2" });
				});
			embeddedservice_bootstrap.init(
				'00DS7000000lsfG',
				'miaw',
				'https://omni2gaproject.stmfa.my.stm.site.com/ESWmiaw1678816691548',
				{
					scrt2URL: 'https://omni2gaproject.stmfa.my.stm.salesforce-scrt.com'
				}
			);
		} catch (err) {
			console.error('Error loading Embedded Messaging: ', err);
		}
	};
</script>
<script type='text/javascript' src='https://omni2gaproject.stmfa.my.stm.site.com/ESWmiaw1678816691548/assets/js/bootstrap.min.js' onload='initEmbeddedMessaging()'></script>

</body>
