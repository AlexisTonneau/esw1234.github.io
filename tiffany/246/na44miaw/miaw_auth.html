<html>
  <head><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"></head>
  <body>
  <button id="launchChat" onclick="launchChat()">LAUNCH CHAT API</button>
  <script>
	function launchChat() {
		embeddedservice_bootstrap.utilAPI.launchChat()
		.then(() => {
			console.log("bootstrap success");
		}).catch(() => {
			console.log("bootstrap failure");
		}).finally(() => {
			console.log("bootstrap finally");
		});
	}
  </script>
    <button onclick="clearSession()">Clear Auth Session</button>
    <script type='text/javascript'>
     window.addEventListener("onEmbeddedMessagingReady", () => {
          console.log("onEmbeddedMessagingReady emitted");
          // Setting identity token
          console.log("Setting identity token.");
          embeddedservice_bootstrap.userVerificationAPI.setIdentityToken({
              "identityTokenType": "JWT",
              "identityToken": "eyJraWQiOiI4OWI5MThlYi0wMzAzLTQ4YjYtYjliOS03NTYyNThjMzYzYTkiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJ0aWZmYW55Iiwic3ViIjoidGlmZmFueSIsImV4cCI6MTY5NDE5OTkzNSwiaWF0IjoxNjkzNTk5OTM1fQ.OotiTgZuhVOTk4X0ZXZ324hcJlLTKKt6bhDWkjYiUqSBF3Rt2djjpubPvLECVx5vQaOGVB00SCyN6DFYq-6h1Pz6dE4_d4aFKVDenkEbiLjBykplo6KkPVXhav4LNR55b-eNvMgem77GX_Gl9OCTdCjt6DHDx2WrKXw_plrjQJ6WTcwKMGXAUzOf_OzApl5gnM0MkI-HH4r9MXzJnN4kNv9mYUma6U25vZoIuhYy1lfTDOHkKqJYNJxPooXRzTPzSKTBeWQn-39NbhIo86RVLJeuK93_qRw5qsQyY8RWM_EHzzgABw7-72Bhwtg4UnCdMG22xmdUILm9JFYHh3kbeg"
          });
      });

    window.addEventListener("onEmbeddedMessagingIdentityTokenExpired", () => {
        console.log("Received the onEmbeddedMessagingIdentityTokenExpired event…");
    
        // Refresh token and then send the new token to Salesforce
        embeddedservice_bootstrap.userVerificationAPI.setIdentityToken({
        "identityTokenType": "JWT", "identityToken": refreshed_jwt });
    
        // Or, instead of refreshing the token, call
        // embeddedservice_bootstrap.userVerificationAPI.clearSession()
        // to clear all session data…
    });

      function clearSession() {
        embeddedservice_bootstrap.userVerificationAPI.clearSession();
      }
    </script>
    <script type='text/javascript'>
	function initEmbeddedMessaging() {
		try {
			embeddedservice_bootstrap.settings.language = 'en_US'; // For example, enter 'en' or 'en-US'
			embeddedservice_bootstrap.settings.devMode = true;
			embeddedservice_bootstrap.init(
				'00DRM000000Nt88',
				'AUTH_PRECHAT_DISABLED',
				'https://na44miaw.stmfa.stm.force.com/ESWAUTHPRECHATDISABLED1691479579187',
				{
					scrt2URL: 'https://na44miaw.my.stmfa.stm.salesforce-scrt.com'
				}
			);
		} catch (err) {
			console.error('Error loading Embedded Messaging: ', err);
		}
	};
</script>
<script type='text/javascript' src='https://na44miaw.stmfa.stm.force.com/ESWAUTHPRECHATDISABLED1691479579187/assets/js/bootstrap.min.js' onload='initEmbeddedMessaging()'></script>
  </body>
</html>
